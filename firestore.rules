rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // By default, deny all reads and writes
    match /{document=**} {
      allow read, write: if false;
    }
    // Allow any authenticated user to read/write to all core collections.
    // We will make these rules more granular in a later phase.
    match /macrogames/{macrogameId} {
      allow read, write: if request.auth != null;
    }
    match /microgames/{microgameId} {
      allow read, write: if request.auth != null;
    }
    match /customMicrogames/{customMicrogameId} {
      allow read, write: if request.auth != null;
    }
    match /campaigns/{campaignId} {
      allow read, write: if request.auth != null;
    }
    match /conversionMethods/{methodId} {
      allow read, write: if request.auth != null;
    }
    match /conversionScreens/{screenId} {
      allow read, write: if request.auth != null;
    }

    // --- NEW COLLECTION ---
    // This replaces the old 'popups' rule
    match /deliveryContainers/{containerId} {
      allow read, write: if request.auth != null;
    }
  }
}